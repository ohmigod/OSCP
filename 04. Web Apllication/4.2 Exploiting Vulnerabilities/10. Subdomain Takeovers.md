# Subdomain Takeovers

> The basic premise of a subdomain takeover is a host that points to a particular service not currently in use, which an adversary can use to serve content on the vulnerable subdomain by setting up an account on the third-party service.

## Example 1:

1. Domain name (e.g., sub.example.com) uses a CNAME record to another domain (e.g., sub.example.com CNAME anotherdomain.com).
2. At some point in time, anotherdomain.com expires and is available for registration by anyone.
3. Since the CNAME record is not deleted from example.com DNS zone, anyone who registers anotherdomain.com has full control over sub.example.com until the DNS record is present.


## Example 2:

Imagine we have stumbled across a subdomain pointing to GitHub pages:

```bash
$ host subdomain.example.com
subdomain.example.com has address 192.30.252.153
subdomain.example.com has address 192.30.252.154
$ whois 192.30.252.153 | grep "OrgName"
OrgName: GitHub, Inc.
```

When navigating to subdomain.example.com, we discover a 404 error page. This 404 page indicates that no content is being served under the top-level directory and that we should attempt to add this subdomain to our personal GitHub repository. 

_____

## Enumeration and discovery

#### Passive

Some services, such as DNS Dumpster and VirusTotal, index subdomains that have been crawled in the past allowing you to collect and sort the results quickly without much effort.
[Sublist3r](https://github.com/aboul3la/Sublist3r.git) script gathers subdomains from numerous search engines, SSL certificates, and websites such as DNS Dumpster.

#### Active

Bruteforcing with tools like dnsenum.

_____

## Exploitation

[Right, now you control a subdomain belonging to the target, what can you do next?](https://www.hackerone.com/blog/Guide-Subdomain-Takeovers#)
